---
layout: post

title:  APP脱壳

description:  APP脱壳

---


App 砸壳记

借助 OC 的动态特性，要想 “学习” 一款应用变得相当的方便。今天讲讲用 class-dump 导出 app 中的可执行文件的头文件。

工具

1、class-dump (或class-dump-z)
2、“脱壳”工具 CrackAddict

关于第一个，笔者推荐两个都装 class-dump, class-dump-z，需自备梯子。网上曾看到有人说 class-dump-z 的速度比 class-dump 快，但是在实际测试时，两者相差不大，至少是我推荐的这个 class-dump 源，在 dump 某些应用的 header 时， class-dump-z 出现了段错误，但是上面下载的那个 class-dump 没有这个问题。 p.s. 这两个都是 OS X 上的工具。

关于第二点，本着脱离低级趣味的主旨，推荐的工具虽然兼有破解应用的附加功能，但是笔者认为看这篇文章的人，大部分都怀揣 “学习” 的心态，希望能善用此工具。安装须在 Cydia 中添加源 http://cydia.appaddict.org ，然后搜索 CrackAddict。

“脱壳”

安装后打开 CrackAddict，找到你“感兴趣”的应用，Make it suffer:

CrackAddict

SSH

破解完后，在 Mac 下用 ssh 连接到设备：

ssh root@192.168.1.100
设备 IP 自己换下，用前需在 Cydia 上安装 openSSH, 连接密码默认 alpine，在 Cydia 的首页有详细说明。关于检测手机 IP 地址，之前写了个 工具，省去了每次都得去设置中查看的麻烦。

openSSH

ssh 到设备后：

cd /User/Documents/Cracked
然后：

ls
就会看到刚破解的那个应用了：

/User/Documents/Cracked

拷贝破解文件

接着在 Mac 的 Terminal 下新建一个 tab：

cmd + t
把设备上的文件拷贝到电脑上：

scp root@192.168.1.100:/User/Documents/Cracked/Facebook-v7.0-crackr-(CrackAddict).ipa /tmp/
cd /tmp
open .
打开 tmp 那个目录，然后把那个 ipa 文件扩展名改为 zip

Facebook-v7.0-crackr-(CrackAddict).zip
然后解压缩，会看到一个叫 Payload 的目录，打开目录，右键 那个 app 文件夹，Show package contents, 然后把里面的那个叫 Facebook 的可执行文件拷贝到一个目录下，比如 /tmp。

然后 Termina cd 到那个 目录，执行：

class-dump -H Facebook -o facebook_h
Facebook 为可执行文件名，-o 后面的参数为导出的头文件保存目录，-H 指明输出的头文件以独立的 .h 的形式保存。具体参数看 help。
P.S. 别忘了把 class-dump / class-dump-z 加入到可执行文件的路径下，必要的情况下设置好可执行的权限。

有了这些头文件就可以配合 Cycript 还有 Reveal 来深入“学习”这款应用了。
